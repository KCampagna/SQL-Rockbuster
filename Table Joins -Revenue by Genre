-- Query with multiple joins to find total revenue generated by genre in top markets

SELECT f.name AS Genre,
	SUM(D.amount) AS total_revenue
FROM film A

INNER JOIN inventory B ON A.film_id = B.film_id
INNER JOIN rental C ON B.inventory_id = C.inventory_id
INNER JOIN payment D ON C.rental_id = D.rental_id
INNER JOIN film_category E ON A.film_id = E.film_id
INNER JOIN category F ON E.category_id = F.category_id
INNER JOIN customer G ON C.customer_id = G.customer_id
INNER JOIN address H ON G.address_id = H.address_id
INNER JOIN city I ON H.city_id = I.city_id
INNER JOIN country J ON I.country_id = J.country_id

WHERE country IN ('India', 'China', 'United States', 'Japan', 'Mexico', 'Brazil',
				 'Philippines', 'Turkey', 'Indonesia')
				 
GROUP BY 1
ORDER BY SUM (D.Amount) DESC
LIMIT 10
